<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>DonJu Gourmet - Postres Premium</title>
  <meta name="description" content="Postres premium en vaso (180ml) por encargo. Cierre 18:00, entrega al dÃ­a siguiente. La Florida y alrededores." />

  <!-- Open Graph -->
  <meta property="og:title" content="DonJu Gourmet â€” Pedidos por WhatsApp" />
  <meta property="og:description" content="Postres 180 ml Â· Cierre 18:00 Â· Entrega al dÃ­a siguiente Â· La Florida y alrededores" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://juliohernandezm40-creator.github.io/donju-gourmet/" />
  <meta property="og:image" content="https://juliohernandezm40-creator.github.io/donju-gourmet/logo.jpg" />
  <meta property="og:locale" content="es_CL" />

  <!-- Preconnect and Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:ital,wght@0,600;0,700;1,600&display=swap" rel="stylesheet">

  <link rel="icon" href="logo.jpg" type="image/jpeg">
  <link rel="apple-touch-icon" href="logo.jpg">

  <style>
    :root {
      --brand-pastel: #FDFBF7;
      --brand-gold: #C2A57A;
      --brand-gold-hover: #D4B88E;
      --brand-dark: #2C2A29;
      --brand-gray: #F0EEE9;
      --text-main: #3D3B3A;
      --text-muted: #73706D;
      --whatsapp: #25D366;
      --whatsapp-hover: #1EBE5A;
      --white: #FFFFFF;
      --danger: #E03E3E;
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 16px rgba(0,0,0,0.08);
      --shadow-gold: 0 4px 20px rgba(194, 165, 122, 0.2);

      --font-serif: 'Playfair Display', serif;
      --font-sans: 'Inter', sans-serif;

      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-full: 9999px;
      --content-max: 1000px;

      --focus: rgba(194,165,122,.45);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      font-family: var(--font-sans);
      color: var(--text-main);
      background-color: var(--brand-pastel);
      line-height: 1.5;
      padding-top: 84px; /* âœ… ajustado por header mÃ¡s alto (logo grande) */
    }

    h1, h2, h3, h4 { font-family: var(--font-serif); color: var(--brand-dark); }
    a { text-decoration: none; color: inherit; }
    button { cursor: pointer; border: none; font-family: inherit; }
    img { max-width: 100%; display: block; }

    :focus-visible {
      outline: 2px solid var(--focus);
      outline-offset: 2px;
      border-radius: 6px;
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
    }

    .container { max-width: var(--content-max); margin: 0 auto; padding: 0 20px; }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 18px;
      border-radius: var(--radius-full);
      font-weight: 600;
      transition: all 0.2s ease;
      min-height: 44px;
      user-select: none;
      white-space: nowrap;
    }
    .btn-gold {
      background: var(--brand-gold);
      color: var(--white);
      box-shadow: var(--shadow-gold);
    }
    .btn-gold:hover { background: var(--brand-gold-hover); transform: translateY(-2px); }
    .btn-outline {
      border: 1px solid var(--brand-gold);
      color: var(--brand-gold);
      background: transparent;
    }
    .btn-outline:hover { background: var(--brand-gold); color: var(--white); }
    .btn-wa {
      background: var(--whatsapp);
      color: var(--white);
    }
    .btn-wa:hover { background: var(--whatsapp-hover); transform: translateY(-2px); }
    .btn:active { transform: translateY(0); opacity: .98; }

    /* âœ… BotÃ³n mÃºsica */
    .btn-music {
      border: 1px solid var(--brand-gold);
      background: rgba(194,165,122,.12);
      color: var(--brand-dark);
    }
    .btn-music:hover {
      background: rgba(194,165,122,.20);
      transform: translateY(-2px);
    }

    .text-center { text-align: center; }

    /* HEADER */
    .header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: rgba(253, 251, 247, 0.95);
      backdrop-filter: blur(8px);
      z-index: 1000;
      box-shadow: var(--shadow-sm);
      height: 84px; /* âœ… mÃ¡s alto para logo grande */
    }
    .header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 100%;
      gap: 12px;
    }
    .logo-container {
      display: flex;
      align-items: center;
      gap: 12px;
      font-family: var(--font-serif);
      font-size: 1.35rem; /* âœ… un poco mÃ¡s grande */
      font-weight: 700;
      color: var(--brand-dark);
      min-width: 0;
    }
    .logo-container span{
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    /* âœ… Logo mÃ¡s grande */
    .logo-img { height: 56px; width: 56px; border-radius: 50%; object-fit: cover; }

    .header-links { display: flex; gap: 10px; align-items: center; }

    /* Banner mÃºsica (cuando autoplay estÃ¡ bloqueado) */
    .music-banner{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      top: 92px;
      width: min(var(--content-max), calc(100% - 40px));
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(194,165,122,.35);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      padding: 12px 14px;
      display: none;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      z-index: 1100;
    }
    .music-banner p{
      margin:0;
      color: var(--text-muted);
      font-size: .95rem;
    }

    /* HERO */
    .hero {
      text-align: center;
      padding: 56px 20px 40px;
      position: relative;
    }
    .hero-title { font-size: 2.5rem; margin-bottom: 14px; }
    .hero-subtitle {
      font-size: 1.05rem;
      color: var(--text-muted);
      max-width: 720px;
      margin: 0 auto 26px;
      font-family: var(--font-serif);
      font-style: italic;
    }
    .hero-anchors { display: flex; justify-content: center; gap: 14px; margin-bottom: 28px; flex-wrap: wrap; }

    /* CAROUSEL */
    .carousel-wrap {
      max-width: 820px;
      margin: 0 auto 18px;
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-md);
      background: var(--brand-gray);
    }
    .carousel {
      display: flex;
      transition: transform 0.5s ease;
      height: 380px;
      will-change: transform;
    }
    .carousel img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      flex-shrink: 0;
    }
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.86);
      color: var(--brand-dark);
      width: 44px; height: 44px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.2rem;
      transition: background 0.2s;
    }
    .carousel-btn:hover { background: #fff; }
    .carousel-prev { left: 14px; }
    .carousel-next { right: 14px; }
    .carousel-dots {
      position: absolute; bottom: 14px; left: 0; right: 0;
      display: flex; justify-content: center; gap: 8px;
    }
    .dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: rgba(255,255,255,0.55);
      cursor: pointer;
      transition: transform .15s ease, background .2s ease;
    }
    .dot.active { background: #fff; transform: scale(1.25); }

    /* SECTION TITLE */
    .section-title { text-align: center; font-size: 2rem; margin: 40px 0 26px; position: relative; }
    .section-title::after {
      content: '';
      display: block;
      width: 60px; height: 3px;
      background: var(--brand-gold);
      margin: 12px auto 0;
      border-radius: 2px;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 22px;
      margin-bottom: 52px;
    }

    .product-card {
      background: var(--white);
      border-radius: var(--radius-md);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      transition: transform 0.2s, box-shadow 0.2s;
      position: relative;
      display: flex;
      flex-direction: column;
    }
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
    }
    .product-img-wrap { position: relative; padding-top: 75%; overflow: hidden; background: var(--brand-gray); }
    .product-img-wrap img {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      object-fit: cover;
    }
    .badge {
      position: absolute; top: 12px; right: 12px;
      padding: 4px 12px;
      border-radius: var(--radius-full);
      font-size: 0.75rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.5px;
    }
    .badge-bestseller { background: var(--brand-gold); color: #fff; }
    .badge-new { background: var(--brand-dark); color: #fff; }

    .product-info { padding: 18px; display: flex; flex-direction: column; flex-grow: 1; }
    .product-name { font-size: 1.25rem; font-family: var(--font-serif); margin-bottom: 8px; }
    .product-desc { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 14px; flex-grow: 1; }
    .product-price { font-size: 1.25rem; font-weight: 700; color: var(--brand-dark); margin-bottom: 14px; }

    .qty-control {
      display: flex; align-items: center; justify-content: space-between;
      background: var(--brand-gray);
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    .qty-btn {
      width: 44px; height: 44px;
      background: transparent;
      font-size: 1.2rem; color: var(--text-main);
    }
    .qty-btn:hover { background: rgba(0,0,0,0.05); }
    .qty-input {
      width: 40px; text-align: center; border: none; background: transparent;
      font-weight: 700; font-size: 1rem;
      -moz-appearance: textfield;
    }
    .qty-input::-webkit-outer-spin-button, .qty-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

    /* Combo selectors */
    .combo-flavors { margin-top: 14px; display: none; }
    .combo-flavors.active { display: block; }
    .combo-select {
      width: 100%; padding: 10px; margin-bottom: 8px;
      border: 1px solid var(--brand-gray);
      border-radius: var(--radius-sm);
      font-family: inherit; font-size: 0.9rem; background: var(--white);
    }

    /* CHECKOUT */
    .checkout-section {
      background: var(--white);
      border-radius: var(--radius-lg);
      padding: 30px;
      box-shadow: var(--shadow-md);
      margin-bottom: 54px;
    }
    .cart-summary { margin-bottom: 26px; }
    .cart-item {
      display: flex; justify-content: space-between; gap: 14px;
      padding: 12px 0;
      border-bottom: 1px solid var(--brand-gray);
      font-size: 0.95rem;
    }
    .cart-item-details { flex-grow: 1; }
    .cart-item-flavors { font-size: 0.85rem; color: var(--text-muted); margin-top: 4px; }
    .cart-item-price { font-weight: 700; white-space: nowrap; }
    .cart-total {
      display: flex; justify-content: space-between;
      font-size: 1.5rem; font-family: var(--font-serif);
      margin-top: 18px; font-weight: 800; color: var(--brand-dark);
    }

    .checkout-form { display: grid; gap: 16px; }
    .form-group { display: flex; flex-direction: column; gap: 6px; }
    .form-group label { font-size: 0.9rem; font-weight: 600; }
    .form-control {
      padding: 12px; border: 1px solid #ddd;
      border-radius: var(--radius-sm); font-family: inherit;
      min-height: 44px;
    }
    .form-control:focus { outline: none; border-color: var(--brand-gold); box-shadow: 0 0 0 3px rgba(194,165,122,.20); }

    .delivery-fields { display: none; }
    .delivery-fields.active { display: grid; gap: 16px; }

    .notice {
      background: #FFF9E6; color: #856404;
      padding: 12px; border-radius: var(--radius-sm);
      font-size: 0.9rem; margin-bottom: 16px;
      display: flex; gap: 8px; align-items: flex-start;
    }

    .alert {
      display: none;
      margin-top: 10px;
      padding: 12px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(224,62,62,.35);
      background: rgba(224,62,62,.10);
      color: #7a1f1f;
      font-size: .95rem;
    }

    /* FAQ */
    .faq-section { margin-bottom: 54px; }
    .faq-item {
      background: var(--white); margin-bottom: 12px;
      border-radius: var(--radius-sm); padding: 16px;
      cursor: pointer; box-shadow: var(--shadow-sm);
    }
    .faq-q { font-weight: 700; display: flex; justify-content: space-between; align-items: center; gap: 10px; }
    .faq-a { margin-top: 12px; font-size: 0.95rem; color: var(--text-muted); display: none; }
    .faq-item.active .faq-a { display: block; }
    .faq-item.active .faq-icon { transform: rotate(45deg); }

    /* FOOTER */
    footer {
      text-align: center; padding: 40px 20px;
      background: var(--brand-dark); color: var(--white);
    }

    /* Floating CTA */
    .floating-cta {
      position: fixed; bottom: 20px; right: 20px;
      z-index: 900; opacity: 0; pointer-events: none;
      transition: opacity 0.3s, transform 0.3s;
      transform: translateY(20px);
    }
    .floating-cta.visible { opacity: 1; pointer-events: auto; transform: translateY(0); }

    @media (max-width: 768px) {
      body { padding-top: 84px; }
      .hero-title { font-size: 2.05rem; }
      .carousel { height: 250px; }
      .checkout-section { padding: 20px; }
      .header-links .btn span { display: none; }
      .header-links .btn { padding: 10px 12px; }
    }
  </style>
</head>

<body>
  <!-- ðŸŽµ AUDIO (sube tu archivo como musica.mp3 en la raÃ­z del repo) -->
  <audio id="bgMusic" src="musica.mp3" preload="auto" loop></audio>

  <!-- Banner si el autoplay estÃ¡ bloqueado -->
  <div class="music-banner" id="musicBanner">
    <p>ðŸŽµ MÃºsica disponible. Toca para activarla.</p>
    <button class="btn btn-music" id="musicBannerBtn" type="button">Activar mÃºsica</button>
  </div>

  <!-- HEADER -->
  <header class="header">
    <div class="container">
      <a href="#top" class="logo-container" aria-label="Inicio DonJu Gourmet">
        <img src="logo.jpg" alt="DonJu Gourmet Logo" class="logo-img"
             onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 100 100\\'><circle cx=\\'50\\' cy=\\'50\\' r=\\'50\\' fill=\\'%23C2A57A\\'/></svg>'">
        <span>DonJu Gourmet</span>
      </a>

      <div class="header-links">
        <!-- BotÃ³n mÃºsica ON/OFF -->
        <button type="button" class="btn btn-music" id="musicToggleBtn" aria-label="MÃºsica">
          <span id="musicToggleText">MÃºsica</span>
        </button>

        <a href="https://www.instagram.com/donju_gourmet" target="_blank" class="btn btn-outline" id="igBtn" aria-label="Instagram">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
            <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
            <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
          </svg>
          <span>Instagram</span>
        </a>

        <button type="button" class="btn btn-wa" id="waQuickBtn" aria-label="WhatsApp consultar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51a12.8 12.8 0 0 0-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 0 0-3.48-8.413Z"/>
          </svg>
          <span>Consultar</span>
        </button>
      </div>
    </div>
  </header>

  <!-- FLOATING CTA -->
  <a href="#checkout" class="btn btn-wa floating-cta" id="floatingCta" aria-label="Ir al pedido">
    Ir al pedido
  </a>

  <!-- HERO -->
  <section class="hero container" id="top">
    <h1 class="hero-title">Momentos dulces, <span style="color: var(--brand-gold);">postres premium</span></h1>
    <p class="hero-subtitle">
      Hechos por encargo para asegurar frescura Â· Cierre 18:00 hrs Â· Entrega al dÃ­a siguiente (180ml)
      <br><span style="font-family: var(--font-sans); font-style: normal; font-size:.95rem;">La Florida Â· Macul Â· PeÃ±alolÃ©n Â· Puente Alto Â· La Granja</span>
    </p>

    <div class="hero-anchors">
      <a href="#menu" class="btn btn-gold">Ver menÃº</a>
      <a href="#combos" class="btn btn-outline">Ver combos</a>
      <a href="#checkout" class="btn btn-wa">Ir al pedido</a>
    </div>

    <div class="carousel-wrap" id="carouselWrap">
      <div class="carousel" id="carousel">
        <img src="tiramisu.jpg" alt="TiramisÃº" loading="eager" onerror="this.src=fallbackImg('Imagen TiramisÃº')">
        <img src="cheesecake-maracuya.jpg" alt="Cheesecake de maracuyÃ¡" loading="lazy" onerror="this.src=fallbackImg('Imagen MaracuyÃ¡')">
        <img src="suspiro-limeno.jpg" alt="Suspiro LimeÃ±o" loading="lazy" onerror="this.src=fallbackImg('Imagen Suspiro')">
        <img src="mousse-manjar.jpg" alt="Mousse de manjar" loading="lazy" onerror="this.src=fallbackImg('Imagen Mousse')">
        <img src="carlota-mango.jpg" alt="Carlota de mango" loading="lazy" onerror="this.src=fallbackImg('Imagen Carlota')">
        <img src="combo5.jpg" alt="Combo 5 postres" loading="lazy" onerror="this.src=fallbackImg('Imagen Combo 5')">
      </div>
      <button class="carousel-btn carousel-prev" id="prevBtn" aria-label="Anterior">&#10094;</button>
      <button class="carousel-btn carousel-next" id="nextBtn" aria-label="Siguiente">&#10095;</button>
      <div class="carousel-dots" id="carouselDots"></div>
    </div>
  </section>

  <section id="menu" class="container">
    <h2 class="section-title">Nuestra Carta</h2>
    <div class="menu-grid" id="productsGrid"></div>
  </section>

  <section id="combos" class="container">
    <h2 class="section-title">Combos</h2>
    <div class="menu-grid" id="combosGrid"></div>
    <p class="text-center" style="color: var(--text-muted); margin-top:-30px; margin-bottom: 40px;">
      Nota: para mantenerlo simple, el sistema permite <strong>1 combo por pedido</strong>. Si quieres mÃ¡s, lo coordinamos por WhatsApp ðŸ˜Š
    </p>
  </section>

  <section id="checkout" class="container">
    <div class="checkout-section">
      <h2 class="section-title" style="margin-top:0;">Tu Pedido</h2>

      <div id="timeNotice" class="notice" style="display:none;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        <span><strong>Aviso:</strong> Si pides despuÃ©s de las 18:00, la entrega se coordina para el dÃ­a siguiente disponible (segÃºn producciÃ³n).</span>
      </div>

      <div class="cart-summary" id="cartSummary">
        <p class="text-center" style="color: var(--text-muted);">AÃºn no has agregado productos.</p>
      </div>

      <div class="alert" id="alertBox"></div>

      <form id="orderForm" class="checkout-form" novalidate>
        <p style="font-family: var(--font-serif); font-size: 1.25rem; border-bottom: 2px solid var(--brand-gray); padding-bottom: 8px; margin-top: 10px;">
          Tus datos
        </p>

        <div class="form-group">
          <label for="f_name">Nombre y apellido *</label>
          <input type="text" id="f_name" class="form-control" placeholder="Ej: Camila PÃ©rez" required>
        </div>

        <div class="form-group">
          <label for="f_type">Tipo de entrega *</label>
          <select id="f_type" class="form-control">
            <option value="delivery">Delivery (a coordinar)</option>
            <option value="retiro">Retiro (a coordinar, La Florida)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="f_comuna">Comuna *</label>
          <select id="f_comuna" class="form-control" required>
            <option value="">Seleccionaâ€¦</option>
            <option value="La Florida">La Florida</option>
            <option value="Macul">Macul</option>
            <option value="PeÃ±alolÃ©n">PeÃ±alolÃ©n</option>
            <option value="Puente Alto">Puente Alto</option>
            <option value="La Granja">La Granja</option>
          </select>
        </div>

        <div id="deliveryFields" class="delivery-fields active">
          <div class="form-group">
            <label for="f_address">DirecciÃ³n completa (si es delivery) *</label>
            <input type="text" id="f_address" class="form-control" placeholder="Calle, nÃºmero, depto/casa">
          </div>
        </div>

        <div class="form-group">
          <label for="f_payment">MÃ©todo de pago</label>
          <select id="f_payment" class="form-control">
            <option value="Transferencia">Transferencia (datos por WhatsApp)</option>
            <option value="Efectivo">Efectivo</option>
          </select>
        </div>

        <div class="form-group">
          <label for="f_notes">Notas (opcional)</label>
          <textarea id="f_notes" class="form-control" rows="2" placeholder="Ej: Es para regalo / Tocar fuerte el timbreâ€¦"></textarea>
        </div>

        <button type="submit" class="btn btn-wa" style="width: 100%; margin-top: 8px; font-size: 1.05rem;">
          Enviar pedido por WhatsApp
        </button>
      </form>
    </div>
  </section>

  <section class="container faq-section">
    <h2 class="section-title">Preguntas Frecuentes</h2>

    <div class="faq-item" data-faq>
      <div class="faq-q">
        Â¿Con cuÃ¡nta anticipaciÃ³n debo pedir?
        <span class="faq-icon" style="transition: transform 0.2s;">+</span>
      </div>
      <div class="faq-a">Debes realizar tu pedido antes de las 18:00 hrs para recibirlo al dÃ­a siguiente (segÃºn producciÃ³n). Si compras despuÃ©s, coordinamos el siguiente dÃ­a disponible.</div>
    </div>

    <div class="faq-item" data-faq>
      <div class="faq-q">
        Â¿CÃ³mo se coordina el pago y la entrega?
        <span class="faq-icon" style="transition: transform 0.2s;">+</span>
      </div>
      <div class="faq-a">Al enviar el pedido serÃ¡s redirigido a nuestro WhatsApp. Confirmamos disponibilidad, horario y detalles de entrega. Si pagas por transferencia, te enviamos los datos por WhatsApp.</div>
    </div>

    <div class="faq-item" data-faq>
      <div class="faq-q">
        Â¿CÃ³mo debo conservar los postres?
        <span class="faq-icon" style="transition: transform 0.2s;">+</span>
      </div>
      <div class="faq-a">Mantener refrigerado. Recomendamos consumir dentro de 48â€“72 horas para la mejor textura y sabor.</div>
    </div>
  </section>

  <footer>
    <div class="container">
      <p style="font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: 8px;">DonJu Gourmet</p>
      <p style="color: var(--brand-gray); font-size: 0.9rem; margin-bottom: 24px;">Postres premium por encargo en formato 180ml.</p>
      <p style="font-size: 0.8rem; color: #aaa;">&copy; <span id="year"></span> DonJu Gourmet. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    // ---------- HELPERS ----------
    function fallbackImg(label){
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='500'>
        <rect width='100%' height='100%' fill='#F0EEE9'/>
        <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Inter, Arial' fill='#73706D' font-size='28'>${label}</text>
      </svg>`;
      return "data:image/svg+xml;utf8," + encodeURIComponent(svg);
    }
    function clp(n){ return "$" + Number(n||0).toLocaleString("es-CL"); }

    const WHATSAPP_NUMBER = "56956059401";
    const STORAGE_KEY = "donju_premium_cart_v1";
    const MUSIC_KEY = "donju_music_enabled_v1";

    // ---------- DATA ----------
    const INDIVIDUALS = [
      { id: "tiramisu", name: "TiramisÃº", desc: "Bizcochos baÃ±ados en cafÃ© y cacao, cremoso y clÃ¡sico.", price: 2000, img: "tiramisu.jpg", badge: "MÃ¡s vendido", badgeClass: "badge-bestseller" },
      { id: "maracuya", name: "Cheesecake MaracuyÃ¡", desc: "Base crocante, crema suave y toque Ã¡cido-tropical.", price: 2000, img: "cheesecake-maracuya.jpg", badge: "", badgeClass: "" },
      { id: "suspiro", name: "Suspiro LimeÃ±o", desc: "Manjar delicado coronado con merengue suave.", price: 2000, img: "suspiro-limeno.jpg", badge: "", badgeClass: "" },
      { id: "mousse", name: "Mousse de Manjar", desc: "Textura aireada y sedosa, full manjar.", price: 2000, img: "mousse-manjar.jpg", badge: "", badgeClass: "" },
      { id: "carlota", name: "Carlota de Mango", desc: "Capas cremosas y refrescantes con mango.", price: 2000, img: "carlota-mango.jpg", badge: "Nuevo", badgeClass: "badge-new" }
    ];
    const COMBOS = [
      { id: "combo3", name: "Combo 3 Postres", desc: "Selecciona 3 sabores a elecciÃ³n.", price: 5500, count: 3, img: "combo3.jpg", badge: "", badgeClass: "" },
      { id: "combo5", name: "Combo 5 Postres", desc: "Selecciona 5 sabores a elecciÃ³n.", price: 9000, count: 5, img: "combo5.jpg", badge: "", badgeClass: "" }
    ];
    const FLAVOR_OPTIONS = INDIVIDUALS.map(p => p.name);

    // STATE
    let cart = {};
    let currentSlide = 0;
    let carouselInterval = null;

    // ---------- DOM READY ----------
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("year").textContent = new Date().getFullYear();

      // FAQ toggle
      document.querySelectorAll("[data-faq]").forEach(el => {
        el.addEventListener("click", () => el.classList.toggle("active"));
      });

      // Buttons
      document.getElementById("prevBtn").addEventListener("click", prevSlide);
      document.getElementById("nextBtn").addEventListener("click", nextSlide);

      document.getElementById("waQuickBtn").addEventListener("click", openQuickWhatsApp);

      // Instagram deep link + fallback
      fixInstagramDeepLink();

      // Render
      renderProducts();

      // Restore state
      loadState();

      // Form handlers
      document.getElementById("f_type").addEventListener("change", () => {
        toggleDeliveryFields();
        saveState();
      });
      ["f_name","f_comuna","f_address","f_payment","f_notes"].forEach(id => {
        document.getElementById(id).addEventListener("input", saveState);
        document.getElementById(id).addEventListener("change", saveState);
      });

      document.getElementById("orderForm").addEventListener("submit", (e) => {
        e.preventDefault();
        sendOrder();
      });

      checkTime();
      initCarousel();

      window.addEventListener("scroll", handleFloatingCta);
      handleFloatingCta();

      toggleDeliveryFields();
      renderCartSummary();

      // ðŸŽµ MÃºsica
      initMusic();
    });

    // ---------- MUSIC ----------
    function initMusic(){
      const audio = document.getElementById("bgMusic");
      const toggleBtn = document.getElementById("musicToggleBtn");
      const toggleText = document.getElementById("musicToggleText");
      const banner = document.getElementById("musicBanner");
      const bannerBtn = document.getElementById("musicBannerBtn");

      // Volumen suave por defecto (ajÃºstalo si quieres)
      audio.volume = 0.35;

      let enabled = localStorage.getItem(MUSIC_KEY);
      if(enabled === null) enabled = "1"; // por defecto: ON
      enabled = enabled === "1";

      function setUI(){
        toggleText.textContent = enabled ? "MÃºsica: ON" : "MÃºsica: OFF";
      }

      async function tryPlay(){
        try{
          await audio.play();
          banner.style.display = "none";
          enabled = true;
          localStorage.setItem(MUSIC_KEY, "1");
          setUI();
        }catch(e){
          // Autoplay bloqueado
          banner.style.display = "flex";
          enabled = false;
          localStorage.setItem(MUSIC_KEY, "0");
          setUI();
        }
      }

      function stop(){
        audio.pause();
        audio.currentTime = 0;
      }

      // Intentar autoplay si estÃ¡ habilitado
      setUI();
      if(enabled){
        tryPlay();
      }else{
        stop();
        banner.style.display = "none";
      }

      // Toggle
      toggleBtn.addEventListener("click", async () => {
        if(enabled){
          enabled = false;
          localStorage.setItem(MUSIC_KEY, "0");
          stop();
          banner.style.display = "none";
          setUI();
        }else{
          await tryPlay();
        }
      });

      // Banner button
      bannerBtn.addEventListener("click", async () => {
        await tryPlay();
      });

      // Si el usuario vuelve a la pestaÃ±a, reintentar si estÃ¡ ON
      document.addEventListener("visibilitychange", () => {
        if(document.visibilityState === "visible"){
          const on = localStorage.getItem(MUSIC_KEY) === "1";
          if(on && audio.paused){
            // intentar play (puede o no)
            audio.play().catch(()=>{});
          }
        }
      });
    }

    // ---------- INSTAGRAM ----------
    function fixInstagramDeepLink(){
      const igBtn = document.getElementById("igBtn");
      if(!igBtn) return;

      const webUrl = "https://www.instagram.com/donju_gourmet/";
      const appUrl = "instagram://user?username=donju_gourmet";

      igBtn.addEventListener("click", (e) => {
        e.preventDefault();
        window.location.href = appUrl;
        setTimeout(() => window.open(webUrl, "_blank"), 800);
      });
    }

    // ---------- CAROUSEL ----------
    function initCarousel(){
      const carousel = document.getElementById("carousel");
      const wrap = document.getElementById("carouselWrap");
      const dotsContainer = document.getElementById("carouselDots");

      const slides = Array.from(carousel.querySelectorAll("img"));

      dotsContainer.innerHTML = "";
      slides.forEach((_, i) => {
        const dot = document.createElement("div");
        dot.className = "dot" + (i === 0 ? " active" : "");
        dot.addEventListener("click", () => goToSlide(i));
        dotsContainer.appendChild(dot);
      });

      startCarousel(slides.length);

      wrap.addEventListener("mouseenter", stopCarousel);
      wrap.addEventListener("mouseleave", () => startCarousel(slides.length));
      wrap.addEventListener("touchstart", stopCarousel, {passive:true});
      wrap.addEventListener("touchend", () => startCarousel(slides.length), {passive:true});

      wrap.dataset.slides = String(slides.length);
      updateCarousel();
    }

    function slidesCount(){
      const wrap = document.getElementById("carouselWrap");
      const n = parseInt(wrap?.dataset?.slides || "0", 10) || 0;
      return Math.max(1, n);
    }

    function updateCarousel(){
      const car = document.getElementById("carousel");
      car.style.transform = `translateX(-${currentSlide * 100}%)`;

      const dots = document.querySelectorAll(".dot");
      dots.forEach((d, i) => d.classList.toggle("active", i === currentSlide));
    }

    function goToSlide(i){
      currentSlide = i;
      updateCarousel();
      stopCarousel();
      startCarousel(slidesCount());
    }

    function nextSlide(){
      const n = slidesCount();
      currentSlide = (currentSlide + 1) % n;
      updateCarousel();
    }

    function prevSlide(){
      const n = slidesCount();
      currentSlide = (currentSlide - 1 + n) % n;
      updateCarousel();
    }

    function startCarousel(n){
      stopCarousel();
      if(n <= 1) return;
      carouselInterval = setInterval(nextSlide, 4000);
    }

    function stopCarousel(){
      if(carouselInterval) clearInterval(carouselInterval);
      carouselInterval = null;
    }

    // ---------- RENDER MENU ----------
    function renderProducts() {
      const pGrid = document.getElementById('productsGrid');
      const cGrid = document.getElementById('combosGrid');

      pGrid.innerHTML = INDIVIDUALS.map(p => createCardStr(p, false)).join("");
      cGrid.innerHTML = COMBOS.map(c => createCardStr(c, true)).join("");

      [...INDIVIDUALS, ...COMBOS].forEach(p => {
        const minus = document.querySelector(`[data-minus="${p.id}"]`);
        const plus  = document.querySelector(`[data-plus="${p.id}"]`);
        if(minus) minus.addEventListener("click", () => changeQty(p.id, -1, !!p.count));
        if(plus)  plus.addEventListener("click", () => changeQty(p.id,  1, !!p.count));
      });
    }

    function createCardStr(product, isCombo) {
      const badgeHtml = product.badge ? `<span class="badge ${product.badgeClass}">${product.badge}</span>` : '';
      let comboHtml = '';

      if (isCombo) {
        let selects = '';
        for(let i=1; i<=product.count; i++){
          let options = `<option value="">Sabor ${i}...</option>`;
          FLAVOR_OPTIONS.forEach(opt => options += `<option value="${opt}">${opt}</option>`);
          selects += `<select class="combo-select sel-${product.id}" data-combo="${product.id}" data-index="${i-1}">${options}</select>`;
        }
        comboHtml = `<div class="combo-flavors" id="flavors-${product.id}">${selects}</div>`;
      }

      return `
        <div class="product-card">
          <div class="product-img-wrap">
            <img src="${product.img}" alt="${product.name}" loading="lazy" onerror="this.src=fallbackImg('Sin imagen')">
            ${badgeHtml}
          </div>
          <div class="product-info">
            <h3 class="product-name">${product.name}</h3>
            <p class="product-desc">${product.desc}</p>
            <div class="product-price">${clp(product.price)}</div>

            <div class="qty-control" aria-label="Cantidad ${product.name}">
              <button class="qty-btn" type="button" data-minus="${product.id}" aria-label="Disminuir">âˆ’</button>
              <input type="number" class="qty-input" id="qty-${product.id}" value="0" min="0" max="20" readonly>
              <button class="qty-btn" type="button" data-plus="${product.id}" aria-label="Aumentar">+</button>
            </div>

            ${comboHtml}
          </div>
        </div>
      `;
    }

    // ---------- CART ----------
    function totalCombosQty(){
      return COMBOS.reduce((acc, c) => acc + (parseInt(document.getElementById(`qty-${c.id}`)?.value || "0",10) || 0), 0);
    }

    function changeQty(id, delta, isCombo) {
      const input = document.getElementById(`qty-${id}`);
      let newQty = (parseInt(input.value, 10) || 0) + delta;
      if(newQty < 0) newQty = 0;

      const isThisCombo = COMBOS.some(c => c.id === id);
      if(isThisCombo && newQty > 1) {
        showAlert("Para mantenerlo simple, el sitio permite solo 1 combo por pedido. Si quieres 2+, lo coordinamos por WhatsApp ðŸ™‚");
        newQty = 1;
      }
      if(!isThisCombo && totalCombosQty() > 1) {
        normalizeCombosToOne();
      }

      input.value = newQty;

      if(isCombo) {
        const flavorsDiv = document.getElementById(`flavors-${id}`);
        if(flavorsDiv) flavorsDiv.classList.toggle('active', newQty > 0);

        if(newQty > 0){
          document.querySelectorAll(`.sel-${id}`).forEach(sel => {
            sel.addEventListener("change", () => {
              updateCartObject();
            }, { once:false });
          });
        }
      }

      updateCartObject();
    }

    function normalizeCombosToOne(){
      const active = COMBOS.filter(c => (parseInt(document.getElementById(`qty-${c.id}`)?.value||"0",10)||0) > 0);
      if(active.length <= 1) return;
      for(let i=1;i<active.length;i++){
        document.getElementById(`qty-${active[i].id}`).value = 0;
        const flavorsDiv = document.getElementById(`flavors-${active[i].id}`);
        if(flavorsDiv) flavorsDiv.classList.remove("active");
      }
      showAlert("Se dejÃ³ solo 1 combo activo (regla del sitio). Si quieres mÃ¡s, lo coordinamos por WhatsApp ðŸ™‚");
    }

    function updateCartObject() {
      cart = {};

      INDIVIDUALS.forEach(p => {
        const qty = parseInt(document.getElementById(`qty-${p.id}`)?.value || "0", 10) || 0;
        if(qty > 0) cart[p.id] = { product: p, qty, flavors: [] };
      });

      let comboPicked = null;
      COMBOS.forEach(c => {
        const qty = parseInt(document.getElementById(`qty-${c.id}`)?.value || "0", 10) || 0;
        if(qty > 0) comboPicked = c;
      });

      if(comboPicked){
        const qty = parseInt(document.getElementById(`qty-${comboPicked.id}`)?.value || "0", 10) || 0;
        const selects = document.querySelectorAll(`.sel-${comboPicked.id}`);
        const flavors = [];
        selects.forEach(s => { if(s.value) flavors.push(s.value); });
        cart[comboPicked.id] = { product: comboPicked, qty, flavors };
      }

      renderCartSummary();
      saveState();
    }

    function renderCartSummary() {
      const summary = document.getElementById('cartSummary');
      const keys = Object.keys(cart);

      if(keys.length === 0) {
        summary.innerHTML = '<p class="text-center" style="color: var(--text-muted);">AÃºn no has agregado productos.</p>';
        return;
      }

      let html = '';
      let total = 0;

      keys.forEach(k => {
        const item = cart[k];
        const subtotal = item.qty * item.product.price;
        total += subtotal;

        let flavorsText = '';
        if(item.product.count) {
          if(item.flavors.length > 0) {
            flavorsText = `<div class="cart-item-flavors">Sabores: ${item.flavors.join(', ')}</div>`;
          } else {
            flavorsText = `<div class="cart-item-flavors">Sabores: pendiente (se puede coordinar por WhatsApp)</div>`;
          }
        }

        html += `
          <div class="cart-item">
            <div class="cart-item-details">
              <strong>${item.qty}x ${item.product.name}</strong>
              ${flavorsText}
            </div>
            <div class="cart-item-price">${clp(subtotal)}</div>
          </div>
        `;
      });

      html += `
        <div class="cart-total">
          <span>Total</span>
          <span>${clp(total)}</span>
        </div>
      `;

      summary.innerHTML = html;
    }

    // ---------- FORM ----------
    function toggleDeliveryFields() {
      const type = document.getElementById('f_type').value;
      const df = document.getElementById('deliveryFields');
      const addr = document.getElementById('f_address');

      if(type === 'delivery') {
        df.classList.add('active');
        addr.setAttribute('required', 'true');
      } else {
        df.classList.remove('active');
        addr.removeAttribute('required');
      }
    }

    function checkTime() {
      const now = new Date();
      const hour = now.getHours();
      if(hour >= 18) document.getElementById('timeNotice').style.display = 'flex';
    }

    function showAlert(msg){
      const box = document.getElementById("alertBox");
      box.textContent = msg;
      box.style.display = "block";
      clearTimeout(window.__alertT);
      window.__alertT = setTimeout(() => { box.style.display = "none"; }, 4500);
    }

    // ---------- STORAGE ----------
    function saveState(){
      const qtyMap = {};
      [...INDIVIDUALS, ...COMBOS].forEach(p => {
        const el = document.getElementById(`qty-${p.id}`);
        qtyMap[p.id] = parseInt(el?.value || "0", 10) || 0;
      });

      const flavorsMap = {};
      COMBOS.forEach(c => {
        const sels = document.querySelectorAll(`.sel-${c.id}`);
        flavorsMap[c.id] = Array.from(sels).map(s => s.value || "");
      });

      const data = {
        qtyMap,
        flavorsMap,
        form: {
          name: document.getElementById('f_name').value || "",
          type: document.getElementById('f_type').value || "delivery",
          comuna: document.getElementById('f_comuna').value || "",
          address: document.getElementById('f_address').value || "",
          payment: document.getElementById('f_payment').value || "Transferencia",
          notes: document.getElementById('f_notes').value || ""
        }
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function loadState(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return;
        const data = JSON.parse(raw);

        if(data?.qtyMap){
          Object.entries(data.qtyMap).forEach(([id, val]) => {
            const el = document.getElementById(`qty-${id}`);
            if(el) el.value = String(val || 0);
          });
        }

        COMBOS.forEach(c => {
          const qty = parseInt(document.getElementById(`qty-${c.id}`)?.value || "0",10) || 0;
          const flavorsDiv = document.getElementById(`flavors-${c.id}`);
          if(flavorsDiv) flavorsDiv.classList.toggle("active", qty > 0);

          const saved = data?.flavorsMap?.[c.id];
          if(saved && saved.length){
            const sels = document.querySelectorAll(`.sel-${c.id}`);
            sels.forEach((s,i) => { if(saved[i]) s.value = saved[i]; });
          }
        });

        normalizeCombosToOne();

        if(data?.form){
          document.getElementById('f_name').value = data.form.name || "";
          document.getElementById('f_type').value = data.form.type || "delivery";
          document.getElementById('f_comuna').value = data.form.comuna || "";
          document.getElementById('f_address').value = data.form.address || "";
          document.getElementById('f_payment').value = data.form.payment || "Transferencia";
          document.getElementById('f_notes').value = data.form.notes || "";
        }

        toggleDeliveryFields();
        updateCartObject();
      }catch(e){}
    }

    // ---------- WHATSAPP ----------
    function openQuickWhatsApp(){
      const hasItems = Object.keys(cart).length > 0;
      if(hasItems){
        const go = confirm("Tienes productos seleccionados. Â¿Quieres ir al pedido para enviarlo?");
        if(go){
          document.getElementById("checkout").scrollIntoView({behavior:"smooth"});
          return;
        }
      }
      const msg = "Hola DonJu Gourmet ðŸ‘‹ Tengo una consulta sobre los postres.";
      window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`, "_blank");
    }

    function sendOrder() {
      const keys = Object.keys(cart);
      if(keys.length === 0) {
        showAlert("Tu carrito estÃ¡ vacÃ­o. Agrega productos primero ðŸ™‚");
        return;
      }

      const name = document.getElementById('f_name').value.trim();
      const type = document.getElementById('f_type').value;
      const comuna = document.getElementById('f_comuna').value;
      const address = document.getElementById('f_address').value.trim();
      const payment = document.getElementById('f_payment').value;
      const notes = document.getElementById('f_notes').value.trim();

      if(!name){
        showAlert("Falta tu nombre y apellido.");
        document.getElementById('f_name').focus();
        return;
      }
      if(!comuna){
        showAlert("Selecciona una comuna.");
        document.getElementById('f_comuna').focus();
        return;
      }
      if(type === 'delivery' && !address){
        showAlert("Si es delivery, agrega tu direcciÃ³n.");
        document.getElementById('f_address').focus();
        return;
      }

      const d = new Date();
      const dateStr = `${d.getFullYear().toString().slice(-2)}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`;
      const timeStr = `${String(d.getHours()).padStart(2,'0')}${String(d.getMinutes()).padStart(2,'0')}`;
      const orderId = `DJ-${dateStr}-${timeStr}`;

      let msg = `*Nuevo Pedido DonJu Gourmet* ðŸ°\nID: ${orderId}\n\n`;
      msg += `*Cliente:* ${name}\n`;
      msg += `*Modalidad:* ${type === 'delivery' ? 'Delivery (a coordinar)' : 'Retiro (a coordinar, La Florida)'}\n`;
      msg += `*Comuna:* ${comuna}\n`;
      if(type === 'delivery') msg += `*DirecciÃ³n:* ${address}\n`;
      msg += `*Pago:* ${payment}\n\n`;
      msg += `*Detalle del Pedido (180ml):*\n`;

      let total = 0;

      keys.forEach(k => {
        const item = cart[k];
        const sub = item.qty * item.product.price;
        total += sub;
        msg += `â–ª ${item.qty}x ${item.product.name} (${clp(sub)})\n`;

        if(item.product.count){
          if(item.flavors.length > 0){
            msg += `   â”” Sabores: ${item.flavors.join(', ')}\n`;
            if(item.flavors.length < item.product.count){
              msg += `   â”” (Faltan ${item.product.count - item.flavors.length} sabores: coordinar)\n`;
            }
          }else{
            msg += `   â”” Sabores: Pendiente por definir\n`;
          }
        }
      });

      msg += `\n*TOTAL:* ${clp(total)}\n`;
      if(notes) msg += `\n*Notas:* ${notes}\n`;
      msg += `\n_Entiendo que los pedidos cierran 18:00 y se entrega al dÃ­a siguiente (segÃºn producciÃ³n)._`;

      const waLink = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(waLink, '_blank');
    }

    // ---------- FLOATING CTA ----------
    function handleFloatingCta(){
      const cta = document.getElementById('floatingCta');
      const checkout = document.getElementById('checkout');
      if(!cta || !checkout) return;

      const checkoutTop = checkout.getBoundingClientRect().top;
      const show = window.scrollY > 420 && checkoutTop > window.innerHeight * 0.5;
      cta.classList.toggle('visible', show);
    }
  </script>
</body>
</html>
