<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DonJu Gourmet ‚Äî Pedidos</title>
  <meta name="description" content="DonJu Gourmet: postres por encargo. Cierre 18:00, entrega al d√≠a siguiente. La Florida, Macul, Pe√±alol√©n, Puente Alto, La Granja." />

  <meta property="og:title" content="DonJu Gourmet ‚Äî Pedidos por WhatsApp" />
  <meta property="og:description" content="Postres 180 ml ¬∑ Cierre 18:00 ¬∑ Entrega al d√≠a siguiente ¬∑ La Florida y alrededores" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://juliohernandezm40-creator.github.io/donju-gourmet/" />

  <style>
    :root{
      --bg:#0b0b0f; --card:#12121a; --muted:#a8a8b3; --text:#f2f2f6;
      --accent:#d7b46a; --accent2:#6ad7b4; --danger:#ff6b6b;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% 0%, #1a1530 0%, var(--bg) 50%);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:980px; margin:0 auto; padding:24px}
    header{
      display:flex; gap:18px; align-items:center; justify-content:space-between;
      padding:18px 18px; background:rgba(18,18,26,.7); border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius); backdrop-filter: blur(10px);
      position:sticky; top:12px; z-index:9;
    }
    .brand{display:flex; flex-direction:column; gap:2px}
    .brand h1{font-size:18px; margin:0; letter-spacing:.3px}
    .brand small{color:var(--muted)}
    .ctaRow{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.03));
      color:var(--text); padding:10px 14px; border-radius:14px; cursor:pointer;
      font-weight:600; text-decoration:none; display:inline-flex; align-items:center; gap:8px;
    }
    .btn.primary{
      border-color: rgba(215,180,106,.55);
      background:linear-gradient(180deg, rgba(215,180,106,.28), rgba(215,180,106,.08));
    }
    .grid{display:grid; gap:16px}
    @media(min-width:900px){ .grid.cols2{grid-template-columns: 1.1fr .9fr} }
    .card{
      background:rgba(18,18,26,.75);
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.28);
    }
    h2{margin:0 0 10px 0; font-size:16px}
    p{margin:0 0 10px 0; color:var(--muted); line-height:1.45}
    .tag{
      display:inline-flex; padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.14); color:var(--muted); font-size:12px;
      margin-right:8px; margin-top:6px;
    }
    .menu{display:grid; gap:12px;}
    .item{
      display:grid; grid-template-columns: 1fr auto;
      gap:10px; align-items:center; padding:12px;
      border-radius:16px; border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
    }
    .item strong{display:block; margin-bottom:2px}
    .price{font-weight:800; color:var(--accent)}
    .qty{display:flex; align-items:center; gap:8px;}
    input[type="number"], input[type="text"], input[type="tel"], select, textarea{
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.25);
      color:var(--text);
      outline:none;
    }
    textarea{min-height:90px; resize:vertical}
    label{display:block; font-size:12px; color:var(--muted); margin:10px 0 6px}
    .row{display:grid; gap:12px}
    @media(min-width:700px){ .row.cols2{grid-template-columns:1fr 1fr} }
    .note{
      padding:10px 12px; border-radius:14px;
      background:rgba(106,215,180,.10);
      border:1px solid rgba(106,215,180,.25);
      color:#d9fff3;
      font-size:13px;
    }
    .warn{
      padding:10px 12px; border-radius:14px;
      background:rgba(255,107,107,.10);
      border:1px solid rgba(255,107,107,.25);
      color:#ffe1e1;
      font-size:13px;
    }
    footer{padding:20px 0; color:var(--muted); font-size:12px}
    .hr{height:1px; background:rgba(255,255,255,.10); margin:14px 0}
    .comboBox{
      margin-top:14px;
      border-radius:16px;
      padding:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
    }
    .comboGrid{
      display:grid;
      gap:10px;
    }
    @media(min-width:700px){ .comboGrid.cols2{grid-template-columns:1fr 1fr} }
    .mini{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>DonJu Gourmet</h1>
        <small>Pedidos por encargo ¬∑ Cierre 18:00 ¬∑ Entrega al d√≠a siguiente</small>
      </div>
      <div class="ctaRow">
        <a class="btn" href="https://www.instagram.com/donju_gourmet" target="_blank" rel="noreferrer">Instagram</a>
        <a class="btn primary" href="#pedido">Pedir ahora</a>
      </div>
    </header>

    <div style="height:14px"></div>

    <div class="grid cols2">
      <section class="card">
        <h2>C√≥mo funciona</h2>
        <p>
          Trabajamos con <b>preventa</b> para asegurar frescura y orden de producci√≥n.
          <br/>‚úÖ <b>Cerramos pedidos</b> a las <b>18:00</b> y <b>entregamos al d√≠a siguiente</b>.
        </p>
        <div class="tag">La Florida</div>
        <div class="tag">Macul</div>
        <div class="tag">Pe√±alol√©n</div>
        <div class="tag">Puente Alto</div>
        <div class="tag">La Granja</div>
        <div class="hr"></div>
        <p><b>Horarios de entrega:</b><br/>
          Lunes a viernes: desde <b>17:00</b><br/>
          S√°bados, domingos y feriados: <b>10:00‚Äì20:00</b>
        </p>
        <div class="note">
          Pagos disponibles: <b>transferencia</b> o <b>efectivo</b>. Delivery: <b>a coordinar</b>.
        </div>
      </section>

      <section class="card" id="menu">
        <h2>Men√∫ ‚Äî Postres (180 ml)</h2>
        <p>Hechos por encargo para asegurar frescura. Cierre 18:00 ¬∑ Entrega al d√≠a siguiente.</p>

        <div class="menu" id="menuList"></div>

        <!-- Selector de sabores (aparece solo si eligen combos) -->
        <div id="comboSelector" class="comboBox" style="display:none;">
          <h2 style="margin-bottom:8px;">Elige sabores del combo</h2>
          <p class="mini">Puedes repetir sabores. Si no eliges aqu√≠, lo coordinamos por WhatsApp.</p>
          <div id="comboFields" class="comboGrid cols2"></div>
        </div>
      </section>
    </div>

    <div style="height:16px"></div>

    <section class="card" id="pedido">
      <h2>Pedido</h2>
      <p>Completa esto y te abrimos WhatsApp con el pedido listo para enviar.</p>

      <div class="row cols2">
        <div>
          <label>Nombre</label>
          <input id="nombre" type="text" placeholder="Ej: Camila" />
        </div>
        <div>
          <label>Tel√©fono (opcional)</label>
          <input id="telefono" type="tel" placeholder="Ej: +56 9 1234 5678" />
        </div>
      </div>

      <div class="row cols2">
        <div>
          <label>Comuna</label>
          <select id="comuna">
            <option>La Florida</option>
            <option>Macul</option>
            <option>Pe√±alol√©n</option>
            <option>Puente Alto</option>
            <option>La Granja</option>
          </select>
        </div>
        <div>
          <label>M√©todo de entrega</label>
          <select id="entrega">
            <option>Delivery (a coordinar)</option>
            <option>Retiro (a coordinar)</option>
          </select>
        </div>
      </div>

      <div class="row cols2">
        <div>
          <label>D√≠a de entrega (d√≠a siguiente al cierre 18:00)</label>
          <input id="dia" type="text" placeholder="Ej: Ma√±ana / Mi√©rcoles / 24-02" />
        </div>
        <div>
          <label>Horario estimado</label>
          <input id="horario" type="text" placeholder="Ej: 18:30 (L-V) / 12:00 (fin de semana)" />
        </div>
      </div>

      <label>Direcci√≥n (si es delivery)</label>
      <input id="direccion" type="text" placeholder="Calle + n√∫mero + depto/casa (si aplica)" />

      <label>Notas (alergias, dedicatoria, etc.)</label>
      <textarea id="notas" placeholder="Ej: sin frutos secos / dedicatoria: 'Feliz cumple'"></textarea>

      <div class="row cols2" style="align-items:end">
        <div>
          <label>M√©todo de pago</label>
          <select id="pago">
            <option>Transferencia</option>
            <option>Efectivo</option>
          </select>
          <div style="height:10px"></div>
          <div class="warn" id="warnBox" style="display:none"></div>
        </div>
        <div style="display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap">
          <button class="btn" onclick="resetForm()">Limpiar</button>
          <button class="btn primary" onclick="enviarWhatsApp()">Enviar por WhatsApp</button>
        </div>
      </div>
    </section>

    <div style="height:16px"></div>

    <section class="card">
      <h2>Transferencia</h2>
      <p>Datos de transferencia se env√≠an por WhatsApp al confirmar tu pedido.</p>
      <div class="note">
        Tip: cuando formalices, puedes sumar ‚Äúlink de pago‚Äù y el sitio no cambia.
      </div>
    </section>

    <footer>
      ¬© <span id="year"></span> DonJu Gourmet ¬∑ Hecho para preventa y pedidos por WhatsApp.
    </footer>
  </div>

  <script>
    // ====== CONFIG ======
    const WHATSAPP_NUMBER = "56956059401"; // sin +, sin espacios

    // Productos con precios
    const PRODUCTS = [
      { id: "p1", name: "Tiramis√∫", desc: "Cremoso, con caf√© y cacao. Sabor cl√°sico DonJu.", price: 2000, type: "single" },
      { id: "p2", name: "Cheesecake de maracuy√°", desc: "Dulce y √°cido balanceado, toque tropical.", price: 2000, type: "single" },
      { id: "p3", name: "Suspiro Lime√±o", desc: "Base de manjar suave y merengue delicado.", price: 2000, type: "single" },
      { id: "p4", name: "Mousse de manjar", desc: "Textura ligera y sedosa, full manjar.", price: 2000, type: "single" },
      { id: "p5", name: "Carlota de mango", desc: "Capas cremosas y refrescantes con mango.", price: 2000, type: "single" },

      { id: "c3", name: "Combo 3 postres (a elecci√≥n)", desc: "Elige sabores aqu√≠ o por WhatsApp. 3 x 180 ml.", price: 5500, type: "combo", picks: 3 },
      { id: "c5", name: "Combo 5 postres (a elecci√≥n)", desc: "Elige sabores aqu√≠ o por WhatsApp. 5 x 180 ml.", price: 9000, type: "combo", picks: 5 },
    ];

    const SINGLES = PRODUCTS.filter(p => p.type === "single");
    const COMBOS  = PRODUCTS.filter(p => p.type === "combo");

    // ====== UI RENDER ======
    document.getElementById("year").textContent = new Date().getFullYear();

    const menuList = document.getElementById("menuList");
    PRODUCTS.forEach(p => {
      const el = document.createElement("div");
      el.className = "item";
      el.innerHTML = `
        <div>
          <strong>${p.name}</strong>
          <div style="color:var(--muted); font-size:12px">${p.desc}</div>
          <div class="price">$${p.price.toLocaleString("es-CL")}</div>
        </div>
        <div class="qty">
          <label style="margin:0; font-size:12px; color:var(--muted)">Cant.</label>
          <input id="${p.id}" type="number" min="0" value="0" style="width:84px" />
        </div>
      `;
      menuList.appendChild(el);
    });

    // ====== COMBO SELECTOR ======
    const comboSelector = document.getElementById("comboSelector");
    const comboFields = document.getElementById("comboFields");

    function getQty(id){
      return parseInt(document.getElementById(id).value || "0", 10);
    }

    function updateComboSelector(){
      // Total picks = suma de (qtyCombo * picks)
      let totalPicks = 0;
      const selectedCombos = [];
      COMBOS.forEach(c => {
        const q = getQty(c.id);
        if(q > 0){
          totalPicks += q * c.picks;
          selectedCombos.push({ combo: c, qty: q });
        }
      });

      if(totalPicks <= 0){
        comboSelector.style.display = "none";
        comboFields.innerHTML = "";
        return;
      }

      comboSelector.style.display = "block";

      // Preservar selecciones ya hechas
      const previous = Array.from(comboFields.querySelectorAll("select")).map(s => s.value);

      comboFields.innerHTML = "";
      for(let i=0; i<totalPicks; i++){
        const wrap = document.createElement("div");
        wrap.innerHTML = `
          <label>Selecci√≥n ${i+1}</label>
          <select id="pick_${i}">
            <option value="">(Elegir sabor)</option>
            ${SINGLES.map(s => `<option value="${escapeHtml(s.name)}">${escapeHtml(s.name)}</option>`).join("")}
          </select>
        `;
        comboFields.appendChild(wrap);
      }

      // Re-aplicar previos
      const selects = comboFields.querySelectorAll("select");
      selects.forEach((sel, idx) => {
        if(previous[idx]) sel.value = previous[idx];
      });
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // Escuchar cambios en cantidades (incluye combos y singles)
    PRODUCTS.forEach(p => {
      document.getElementById(p.id).addEventListener("input", updateComboSelector);
    });

    function getComboPicksSummary(){
      if(comboSelector.style.display === "none") return "";

      const picks = Array.from(comboFields.querySelectorAll("select"))
        .map(s => s.value)
        .filter(v => v && v.trim().length > 0);

      if(picks.length === 0) return "Sabores combo: (sin seleccionar, a coordinar por WhatsApp)";

      // Conteo
      const count = {};
      picks.forEach(p => count[p] = (count[p] || 0) + 1);

      const parts = Object.entries(count).map(([name, n]) => `${n} x ${name}`);
      return `Sabores combo: ${parts.join(" ¬∑ ")}`;
    }

    // Inicial
    updateComboSelector();

    // ====== ORDER BUILD ======
    function buildOrderLines(){
      const lines = [];
      let total = 0;

      PRODUCTS.forEach(p => {
        const qty = getQty(p.id);
        if(qty > 0){
          const sub = qty * p.price;
          total += sub;
          lines.push(`- ${p.name} x${qty} = $${sub.toLocaleString("es-CL")}`);
        }
      });

      return { lines, total };
    }

    function enviarWhatsApp(){
      const nombre = document.getElementById("nombre").value.trim() || "(sin nombre)";
      const telefono = document.getElementById("telefono").value.trim();
      const comuna = document.getElementById("comuna").value;
      const entrega = document.getElementById("entrega").value;
      const dia = document.getElementById("dia").value.trim() || "(sin fecha)";
      const horario = document.getElementById("horario").value.trim() || "(sin horario)";
      const direccion = document.getElementById("direccion").value.trim();
      const notas = document.getElementById("notas").value.trim();
      const pago = document.getElementById("pago").value;

      const { lines, total } = buildOrderLines();

      const warnBox = document.getElementById("warnBox");
      warnBox.style.display = "none";
      warnBox.textContent = "";

      if(lines.length === 0){
        warnBox.style.display = "block";
        warnBox.textContent = "Te falta elegir al menos 1 √≠tem (cantidad mayor a 0).";
        return;
      }
      if(entrega.toLowerCase().includes("delivery") && !direccion){
        warnBox.style.display = "block";
        warnBox.textContent = "Si es delivery, agrega la direcci√≥n para coordinar.";
        return;
      }

      const comboSummary = getComboPicksSummary();
      const includeComboSummary = (getQty("c3") > 0 || getQty("c5") > 0);

      const msg =
`Hola DonJu Gourmet üëã
Soy: ${nombre}${telefono ? ` (Tel: ${telefono})` : ""}

üßÅ Pedido (180 ml):
${lines.join("\n")}
Total: $${total.toLocaleString("es-CL")}
${includeComboSummary ? `\nüéÅ ${comboSummary}\n` : ""}

üìç Comuna: ${comuna}
üöö Entrega: ${entrega} (a coordinar)
üìÖ D√≠a: ${dia}
üïí Hora: ${horario}
${direccion ? `üè† Direcci√≥n: ${direccion}\n` : ""}üí≥ Pago: ${pago}
${notas ? `üìù Notas: ${notas}\n` : ""}

(Entiendo que los pedidos cierran 18:00 y se entrega al d√≠a siguiente ‚úÖ)`;

      const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(url, "_blank");
    }

    function resetForm(){
      document.getElementById("nombre").value = "";
      document.getElementById("telefono").value = "";
      document.getElementById("dia").value = "";
      document.getElementById("horario").value = "";
      document.getElementById("direccion").value = "";
      document.getElementById("notas").value = "";
      document.getElementById("pago").value = "Transferencia";

      PRODUCTS.forEach(p => document.getElementById(p.id).value = 0);

      comboFields.innerHTML = "";
      comboSelector.style.display = "none";

      const warnBox = document.getElementById("warnBox");
      warnBox.style.display = "none";
      warnBox.textContent = "";
    }
  </script>
</body>
</html>
